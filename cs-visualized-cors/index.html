<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS, åº„å¼•çš„åšå®¢">
    <meta name="description" content="
âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS - DEV


Itâ€™s every developerâ€™s frustration once in a while to see that big red Access to fetc">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS | åº„å¼•çš„åšå®¢</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">åº„å¼•çš„åšå®¢</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">åº„å¼•çš„åšå®¢</div>
        <div class="logo-desc">
            
            æ— ç¥è®ºè€… æ— å…šæ´¾äººå£« è‹¥æ‰¹è¯„ä¸è‡ªç”± åˆ™èµç¾æ— æ„ä¹‰ ä½†æ¯«æ— æ ¹æ®çš„æ±¡è”‘è¯‹æ¯åˆ™æ— è€»è‡³æ ä¸»è§‚åæ¿€ç›‘ç£æ‰¹è¯„å…¬æƒåŠ› èººå¹³è€… æ— ç¥è®ºè€… æ— å…šæ´¾äººå£« å¼‚æ€§æ‹ æœ‰å¤„å¥³æƒ…ç»“ ä¸æŠ½çƒŸä¸å–é…’ä¸è¹¦è¿ªä¸è¿½æ˜Ÿä¸å…»å® ç‰©å¥½è‰²
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/2.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Visualized/">
                                <span class="chip bg-color">Visualized</span>
                            </a>
                        
                            <a href="/tags/CORS/">
                                <span class="chip bg-color">CORS</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Front-End/" class="post-category">
                                Front-End
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2020-07-27
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p><a target="_blank" rel="noopener" href="https://dev.to/lydiahallie/cs-visualized-cors-5b8h">âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS - DEV</a></p>
</blockquote>
<p><img src="/images/pokn6wy4nwkx7s5bkd9w.png" alt="Cover image for âœ‹ğŸ¼ğŸ”¥ CS Visualized: CORS"></p>
<p>Itâ€™s every developerâ€™s frustration once in a while to see that big red <code>Access to fetched has been blocked by CORS policy</code> error in your console! ğŸ˜¬ Although there are some ways to quickly get rid of this error, letâ€™s not take anything for granted today! Instead, letâ€™s see what CORS is actually doing, and why itâ€™s actually our friend ğŸ‘ğŸ¼</p>
<blockquote>
<p>æ¯ä¸ªå¼€å‘äººå‘˜éƒ½ä¼šä¸æ—¶æ„Ÿåˆ°æ²®ä¸§,æ§åˆ¶å°ä¸­çš„å› ä¸º CORS æ”¿ç­–å·²é˜»æ­¢å¯¹è·å–è®¿é—®çš„å¤§çº¢è‰²é”™è¯¯ï¼ ğŸ˜¬ å°½ç®¡æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥å¿«é€Ÿæ¶ˆé™¤æ­¤é”™è¯¯,ä½†ä»Šå¤©æˆ‘ä»¬ä¸è¦å°†ä»»ä½•äº‹æƒ…è§†ä¸ºç†æ‰€å½“ç„¶ï¼ç›¸å,è®©æˆ‘ä»¬çœ‹çœ‹ CORS å®é™…åœ¨åšä»€ä¹ˆ,ä»¥åŠä¸ºä»€ä¹ˆå®ƒå®é™…ä¸Šæ˜¯æˆ‘ä»¬çš„æœ‹å‹ ğŸ‘ğŸ¼</p>
</blockquote>
<blockquote>
<p>â—ï¸ In this blog post I wonâ€™t explain HTTP basics. In case youâ€™d like to know more about HTTP requests and responses, I wrote <a target="_blank" rel="noopener" href="https://www.lydiahallie.dev/blog/http11">a small blog post</a> about it a while ago though ğŸ™‚ In my examples I use HTTP/1.1 instead of HTTP/2, this doesnâ€™t affect CORS.</p>
</blockquote>
<blockquote>
<p>â—ï¸ åœ¨æ­¤åšå®¢æ–‡ç« ä¸­,æˆ‘ä¸ä¼šè§£é‡Š HTTP åŸºç¡€çŸ¥è¯†.å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šæœ‰å…³ HTTP è¯·æ±‚å’Œå“åº”çš„ä¿¡æ¯,å°½ç®¡æˆ‘åœ¨å‰ä¸ä¹…å†™äº†ä¸€ç¯‡æœ‰å…³å®ƒçš„å°åšå®¢æ–‡ç«  åœ¨æˆ‘çš„ç¤ºä¾‹ä¸­,æˆ‘ä½¿ç”¨ HTTP / 1.1 ä»£æ›¿ HTTP / 2,ä½†è¿™ä¸ä¼šå½±å“ CORS.</p>
</blockquote>
<hr>
<p>On the frontend, we often want to display data thatâ€™s located elsewhere! Before we can display this data, the browser first has to make a request to a server in order to fetch that data! The client sends an HTTP request with all the information that the server needs in order to send that data back to the client ğŸ™‚</p>
<blockquote>
<p>åœ¨å‰ç«¯,æˆ‘ä»¬ç»å¸¸è¦æ˜¾ç¤ºå…¶ä»–åœ°æ–¹çš„æ•°æ®ï¼åœ¨æˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºè¿™äº›æ•°æ®ä¹‹å‰,æµè§ˆå™¨é¦–å…ˆå¿…é¡»å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ä»¥è·å–è¯¥æ•°æ®ï¼å®¢æˆ·ç«¯å‘é€ HTTP è¯·æ±‚,å…¶ä¸­åŒ…å«æœåŠ¡å™¨éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯,ä»¥ä¾¿å°†è¯¥æ•°æ®å‘é€å›å®¢æˆ·ç«¯.</p>
</blockquote>
<p>Letâ€™s say weâ€™re trying to fetch some user information on our <code>www.mywebsite.com</code> website from a server thatâ€™s located at <code>api.website.com</code>!</p>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å°è¯•ä» <code>api.website.com</code> ä¸Šçš„æœåŠ¡å™¨ä¸Šè·å–æˆ‘ä»¬çš„ <code>www.mywebsite.com</code> ç½‘ç«™ä¸Šçš„ä¸€äº›ç”¨æˆ·ä¿¡æ¯ï¼</p>
</blockquote>
<p><img src="/images/qyeikeonofi8dfl0jz2t.gif" alt="ä» api.website.com ä¸Šçš„æœåŠ¡å™¨ä¸Šè·å–æˆ‘ä»¬çš„ www.mywebsite.com ç½‘ç«™ä¸Šçš„ä¸€äº›ç”¨æˆ·ä¿¡æ¯"></p>
<p>Perfect! ğŸ˜ƒ We just sent an HTTP request to the server, which then responded with the JSON data we asked for.</p>
<blockquote>
<p>å®Œç¾ï¼ æˆ‘ä»¬åªæ˜¯å‘æœåŠ¡å™¨å‘é€äº† HTTP è¯·æ±‚,ç„¶åæœåŠ¡å™¨ç”¨æˆ‘ä»¬è¦æ±‚çš„ JSON æ•°æ®è¿›è¡Œå“åº”.</p>
</blockquote>
<p>Letâ€™s try the <em>exact same</em> request but from <strong>another domain</strong>. Instead of making the request from <code>www.mywebsite.com</code>, weâ€™re now making the request from a website located at <code>www.anotherdomain.com</code>.</p>
<blockquote>
<p>è®©æˆ‘ä»¬å°è¯•å®Œå…¨ç›¸åŒçš„è¯·æ±‚,ä½†æ¥è‡ªå¦ä¸€ä¸ªåŸŸ.ç°åœ¨,æˆ‘ä»¬ä¸æ˜¯ä» <code>www.mywebsite.com</code> å‘å‡ºè¯·æ±‚,è€Œæ˜¯ä»ä½äº <code>www.anotherdomain.com</code> çš„ç½‘ç«™å‘å‡ºè¯·æ±‚.</p>
</blockquote>
<p><img src="/images/lxhuh29biuwhefs3k9d9.gif" alt="ä»ä½äº www.anotherdomain.com çš„ç½‘ç«™å‘å‡ºè¯·æ±‚ æµè§ˆå™¨å‘æˆ‘ä»¬æ˜¾ç¤ºäº†ä¸€ä¸ªå¥‡æ€ªçš„é”™è¯¯"></p>
<p>Wait, what? We sent the exact same request, but this time the browser shows us a weird error?</p>
<blockquote>
<p>ç­‰ä¸€ä¸‹æˆ‘ä»¬å‘é€äº†å®Œå…¨ç›¸åŒçš„è¯·æ±‚,ä½†æ˜¯è¿™æ¬¡æµè§ˆå™¨å‘æˆ‘ä»¬æ˜¾ç¤ºäº†ä¸€ä¸ªå¥‡æ€ªçš„é”™è¯¯ï¼Ÿ</p>
</blockquote>
<p>We just saw CORS in action! ğŸ’ªğŸ¼ Letâ€™s see why this error occurred, and what it exactly means.</p>
<blockquote>
<p>æˆ‘ä»¬åˆšåˆšçœ‹åˆ° CORS å‘æŒ¥äº†ä½œç”¨ï¼ ğŸ’ªğŸ¼ è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿæ­¤é”™è¯¯çš„åŸå› åŠå…¶ç¡®åˆ‡å«ä¹‰.</p>
</blockquote>
<hr>
<h2 id="âœ‹ğŸ¼-Same-Origin-Policy"><a href="#âœ‹ğŸ¼-Same-Origin-Policy" class="headerlink" title="âœ‹ğŸ¼ Same-Origin Policy"></a>âœ‹ğŸ¼ Same-Origin Policy</h2><p>The web enforces something called the <strong>same-origin policy</strong>. By default, we can only access resources that are located at the <strong>same origin</strong> as the origin of our request! ğŸ’ªğŸ¼ Itâ€™s totally okay to load an image thatâ€™s located at <code>https://mywebsite.com/image1.png</code>, for example.</p>
<blockquote>
<p>ç½‘ç»œå¼ºåˆ¶æ‰§è¡Œä¸€ç§ç§°ä¸ºâ€åŒæºç­–ç•¥â€çš„ç­–ç•¥.é»˜è®¤æƒ…å†µä¸‹,æˆ‘ä»¬åªèƒ½è®¿é—®ä¸è¯·æ±‚æºç›¸åŒçš„èµ„æºï¼ ğŸ’ªğŸ¼ ä¾‹å¦‚,å®Œå…¨å¯ä»¥åŠ è½½ä½äº <code>https://mywebsite.com/image1.png</code> çš„å›¾åƒ.</p>
</blockquote>
<p>A resource is cross-origin when itâ€™s located at a different (sub)domain, protocol, or port!</p>
<blockquote>
<p><strong>å½“èµ„æºä½äºä¸åŒçš„(å­)åŸŸ,åè®®æˆ–ç«¯å£æ—¶,å®ƒå°±æ˜¯è·¨åŸŸçš„</strong>ï¼</p>
</blockquote>
<p><img src="/images/ibyoyo1yqta9cdvh0tbv.jpeg" alt="å½“èµ„æºä½äºä¸åŒçš„(å­)åŸŸ,åè®®æˆ–ç«¯å£æ—¶,å®ƒå°±æ˜¯è·¨åŸŸçš„"></p>
<p>Cool, but why does the same-origin policy even exist?</p>
<blockquote>
<p>ä½†æ˜¯ä¸ºä»€ä¹ˆå­˜åœ¨åŒæºæ”¿ç­–ï¼Ÿ</p>
</blockquote>
<p>Letâ€™s say that the same-origin policy didnâ€™t exist, and you accidentally clicked one of the many virus links your aunt sent you on Facebook. This link redirects you to an â€œevil websiteâ€ that has an iframe embedded which loads your bankâ€™s website, and successfully logs you in by some set cookies! ğŸ˜¬</p>
<blockquote>
<p>å‡è®¾ä¸å­˜åœ¨åŒæºæ”¿ç­–,æ‚¨æ— æ„ä¸­å•å‡»äº†å§‘å§‘åœ¨ Facebook ä¸Šå‘é€ç»™æ‚¨çš„ä¼—å¤šç—…æ¯’é“¾æ¥ä¹‹ä¸€.æ­¤é“¾æ¥ä¼šå°†æ‚¨é‡å®šå‘åˆ°ä¸€ä¸ªåµŒå…¥äº† iframe çš„â€é‚ªæ¶ç½‘ç«™â€,è¯¥ iframe ä¼šåŠ è½½æ‚¨çš„é“¶è¡Œç½‘ç«™,å¹¶é€šè¿‡è®¾ç½®çš„ Cookie æˆåŠŸç™»å½•æ‚¨ï¼ ğŸ˜¬</p>
</blockquote>
<p>The developers of this â€œevil websiteâ€ made it possible for the website to access this iframe and interact with the DOM contents of your bankâ€™s website in order to send money to their account on your behalf!</p>
<blockquote>
<p>è¿™ä¸ªâ€é‚ªæ¶ç½‘ç«™â€çš„å¼€å‘äººå‘˜ä½¿è¯¥ç½‘ç«™å¯ä»¥è®¿é—®æ­¤ iframe,å¹¶ä¸æ‚¨é“¶è¡Œç½‘ç«™çš„ DOM å†…å®¹è¿›è¡Œäº¤äº’,ä»¥ä¾¿å†’å……æ‚¨æ±‡æ¬¾åˆ°ä»–ä»¬çš„å¸æˆ·ï¼</p>
</blockquote>
<p><img src="/images/50nmgrnkf6pb6gphno06.gif" alt="Alt Text"></p>
<p>Yeahâ€¦ this is a huge security risk! We donâ€™t want anyone to just be able to access everything ğŸ˜§</p>
<blockquote>
<p>æ˜¯çš„â€¦è¿™æ˜¯å·¨å¤§çš„å®‰å…¨é£é™©ï¼æˆ‘ä»¬ä¸å¸Œæœ›ä»»ä½•äººéƒ½èƒ½è®¿é—®æ‰€æœ‰å†…å®¹ ğŸ˜§</p>
</blockquote>
<p>Luckily, the same-origin policy helps us out here! This policy makes sure that we can only access resources from the <strong>same origin</strong>.</p>
<blockquote>
<p>å¹¸è¿çš„æ˜¯,åŒæºæ”¿ç­–å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜ï¼è¿™é¡¹æ”¿ç­–ç¡®ä¿æˆ‘ä»¬åªèƒ½è®¿é—®åŒä¸€æ¥æºçš„èµ„æº.</p>
</blockquote>
<p><img src="/images/8unei9l9enunbpr58o54.gif" alt="Alt Text"></p>
<p>In this case, the origin <code>www.evilwebsite.com</code> tried to access cross-origin resources from <code>www.bank.com</code>! The same-origin policy blocked this from happening and made sure that the evil websiteâ€™s devs couldnâ€™t just access our bank data ğŸ¥³</p>
<blockquote>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹,å½“ <code>www.evilwebsite.com</code> è¯•å›¾ä» <code>www.bank.com</code> è®¿é—®è·¨åŸŸèµ„æºï¼åŒæºæ”¿ç­–é˜»æ­¢äº†è¿™ç§æƒ…å†µçš„å‘ç”Ÿ,å¹¶ç¡®ä¿é‚ªæ¶ç½‘ç«™çš„å¼€å‘äººå‘˜ä¸èƒ½è®¿é—®æˆ‘ä»¬çš„é“¶è¡Œæ•°æ®</p>
</blockquote>
<p>Okay, soâ€¦ what does this have to do with CORS?</p>
<blockquote>
<p>å¥½çš„,é‚£â€¦è¿™ä¸ CORS æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
</blockquote>
<hr>
<h2 id="ğŸ”¥-Client-side-CORS"><a href="#ğŸ”¥-Client-side-CORS" class="headerlink" title="ğŸ”¥ Client-side CORS"></a>ğŸ”¥ Client-side CORS</h2><p>Although the same-origin policy actually only applies to scripts, browsers â€œextendedâ€ this policy for JavaScript requests: by default, we can only access fetched resources from the <strong>same origin</strong>!</p>
<blockquote>
<p>å°½ç®¡åŒæºç­–ç•¥å®é™…ä¸Šä»…é€‚ç”¨äºè„šæœ¬,ä½†æ˜¯æµè§ˆå™¨å°†æ­¤ç­–ç•¥â€æ‰©å±•â€ç”¨äº JavaScript è¯·æ±‚:é»˜è®¤æƒ…å†µä¸‹,æˆ‘ä»¬åªèƒ½è®¿é—®æ¥è‡ªç›¸åŒæºçš„èµ„æºï¼</p>
</blockquote>
<p><img src="/images/0qe4yzasvrm7r0a76kui.gif" alt="æˆ‘ä»¬åªèƒ½è®¿é—®æ¥è‡ªç›¸åŒæºçš„èµ„æº"></p>
<p>Hmm, butâ€¦ We often have to access cross-origin resources ğŸ¤” Maybe our frontend needs to interact with our backend API in order to load the data? In order to allow cross-origin requests safely, the browser uses a mechanism called <strong>CORS</strong>! ğŸ¥³</p>
<blockquote>
<p>å—¯,ä½†æ˜¯â€¦æˆ‘ä»¬ç»å¸¸å¿…é¡»è®¿é—®è·¨åŸŸèµ„æº ğŸ¤” ä¹Ÿè®¸æˆ‘ä»¬çš„å‰ç«¯éœ€è¦ä¸åç«¯ API è¿›è¡Œäº¤äº’æ‰èƒ½åŠ è½½æ•°æ®ï¼Ÿä¸ºäº†å®‰å…¨åœ°å…è®¸è·¨åŸŸè¯·æ±‚,æµè§ˆå™¨ä½¿ç”¨äº†ä¸€ç§ç§°ä¸º CORS çš„æœºåˆ¶ï¼ ğŸ¥³</p>
</blockquote>
<p>CORS stands for <strong>Cross-Origin Resource Sharing</strong>. Although the browser disallows us from accessing resources that arenâ€™t located at the same origin, we can use CORS to change those security restrictions a bit while still making sure that weâ€™re accessing those resources safely ğŸ‰</p>
<blockquote>
<p>CORS ä»£è¡¨è·¨åŸŸèµ„æºå…±äº«.å°½ç®¡æµè§ˆå™¨ç¦æ­¢æˆ‘ä»¬è®¿é—®ä¸åŒæ¥æºçš„èµ„æº,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CORS ç¨å¾®æ›´æ”¹è¿™äº›å®‰å…¨é™åˆ¶,åŒæ—¶ä»ç„¶ç¡®ä¿æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°è®¿é—®è¿™äº›èµ„æº ğŸ‰</p>
</blockquote>
<p>User agents (a browser, for example) can use the CORS mechanism in order to <strong>allow cross-origin requests</strong> which otherwise wouldâ€™ve been blocked, based on the values of certain CORS-specific headers in the HTTP response! âœ…</p>
<blockquote>
<p>ç”¨æˆ·ä»£ç†(ä¾‹å¦‚æµè§ˆå™¨)å¯ä»¥ä½¿ç”¨ CORS æœºåˆ¶,ä»¥å…è®¸åŸºäº HTTP å“åº”ä¸­æŸäº› CORS ç‰¹å®šæ ‡å¤´çš„å€¼çš„è·¨åŸŸè¯·æ±‚,å¦åˆ™è¯¥è·¨åŸŸè¯·æ±‚å°†è¢«é˜»æ­¢ï¼ âœ…</p>
</blockquote>
<p>When a cross-origin request is made, the client automatically adds an extra header to our HTTP request: <code>Origin</code>. The value of the <code>Origin</code> header is the origin where the request came from!</p>
<blockquote>
<p>è¿›è¡Œè·¨åŸŸè¯·æ±‚æ—¶,å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨å‘æˆ‘ä»¬çš„ HTTP è¯·æ±‚ä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„æ ‡å¤´:Origin. Origin æ ‡å¤´çš„å€¼æ˜¯è¯·æ±‚çš„æ¥æºï¼</p>
</blockquote>
<p><img src="/images/91qh9mo3q5lcl0ng4t0r.gif" alt="Alt Text"></p>
<p>In order for the browser to allow accessing cross-origin resources, it expects certain headers from the serverâ€™s response, which specify whether this server allows cross-origin requests!</p>
<blockquote>
<p>ä¸ºäº†ä½¿æµè§ˆå™¨å…è®¸è®¿é—®è·¨åŸŸèµ„æº,å®ƒéœ€è¦æœåŠ¡å™¨å“åº”ä¸­çš„æŸäº›æ ‡å¤´,è¿™äº›æ ‡å¤´æŒ‡å®šæ­¤æœåŠ¡å™¨æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ï¼</p>
</blockquote>
<hr>
<h2 id="ğŸ’»-Server-side-CORS"><a href="#ğŸ’»-Server-side-CORS" class="headerlink" title="ğŸ’» Server-side CORS"></a>ğŸ’» Server-side CORS</h2><p>As a server developer, we can make sure that cross-origin requests are allowed by adding extra headers to the HTTP response, which all start with <code>Access-Control-*</code> ğŸ”¥ Based on the values of these CORS response headers, the browser can now allow certain cross-origin responses which wouldâ€™ve normally been blocked by the same-origin policy!</p>
<blockquote>
<p>ä½œä¸ºæœåŠ¡å™¨å¼€å‘äººå‘˜,æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘ HTTP å“åº”æ·»åŠ é¢å¤–çš„æ ‡å¤´æ¥ç¡®ä¿å…è®¸è·¨åŸŸè¯·æ±‚,è¿™äº›æ ‡å¤´å‡ä»¥ <code>Access-Control-*</code>å¼€å¤´ åŸºäºè¿™äº› CORS å“åº”æ ‡å¤´çš„å€¼,æµè§ˆå™¨ç°åœ¨å¯ä»¥å…è®¸æŸäº›é€šå¸¸ä¼šè¢«è·¨åŸŸç­–ç•¥é˜»æ­¢è·¨åŸŸå“åº”ï¼</p>
</blockquote>
<p>Although there are <a target="_blank" rel="noopener" href="https://fetch.spec.whatwg.org/#http-responses">several CORS headers</a> we can use, there is one header that the browser needs in order to allow cross-origin resource access: <code>Access-Control-Allow-Origin</code>! ğŸ™‚</p>
<blockquote>
<p>å°½ç®¡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ª CORS æ ‡å¤´,ä½†æ˜¯æµè§ˆå™¨éœ€è¦ä¸€ä¸ªæ ‡å¤´æ‰èƒ½å…è®¸è·¨åŸŸèµ„æºè®¿é—®:<code>Access-Control-Allow-Origin</code>ï¼ ğŸ™‚</p>
</blockquote>
<p>The value of this header specifies <strong>which origins are allowed to access the resources</strong> that theyâ€™re requesting from the server.</p>
<blockquote>
<p>æ­¤æ ‡å¤´çš„å€¼æŒ‡å®šå…è®¸å“ªäº›æ¥æºè®¿é—®å®ƒä»¬ä»æœåŠ¡å™¨è¯·æ±‚çš„èµ„æº.</p>
</blockquote>
<p>If weâ€™re developing a server that <code>https://mywebsite.com</code> should have access to, we can add the value of that domain to the <code>Access-Control-Allow-Origin</code> header!</p>
<blockquote>
<p>å¦‚æœæˆ‘ä»¬æ­£åœ¨å¼€å‘<a target="_blank" rel="noopener" href="https://mywebsite.comåº”è¯¥å¯ä»¥è®¿é—®çš„æœåŠ¡å™¨,åˆ™å¯ä»¥å°†è¯¥åŸŸçš„å€¼æ·»åŠ åˆ°access-control-allow-originæ ‡å¤´ä¸­!/">https://mywebsite.comåº”è¯¥å¯ä»¥è®¿é—®çš„æœåŠ¡å™¨,åˆ™å¯ä»¥å°†è¯¥åŸŸçš„å€¼æ·»åŠ åˆ°Access-Control-Allow-Originæ ‡å¤´ä¸­ï¼</a></p>
</blockquote>
<p><img src="/images/bpw6vwe6w5tm3cadqg7j.gif" alt="Alt Text"></p>
<p>Awesome! ğŸ‰ This header is now added to the response that the server sends back to the client. By adding this header, the <strong>same-policy origin will no longer restrict us from receiving resources</strong> that were located at the <code>https://api.mywebsite.com</code> origin, if we sent the request from <code>https://mywebsite.com</code>!</p>
<blockquote>
<p>å¤ªæ£’äº†ï¼ ç°åœ¨ header å·²æ·»åŠ åˆ°æœåŠ¡å™¨å‘é€å›å®¢æˆ·ç«¯çš„å“åº”æ ‡å¤´ä¸­.é€šè¿‡æ·»åŠ æ­¤æ ‡å¤´,å¦‚æœæˆ‘ä»¬ä» <code>https://mywebsite.com</code> å‘é€è¯·æ±‚,åˆ™ç›¸åŒç­–ç•¥æ¥æºå°†ä¸å†é™åˆ¶æˆ‘ä»¬æ¥æ”¶ä½äº <code>https://api.mywebsite.com</code> æ¥æºçš„èµ„æºï¼</p>
</blockquote>
<p><img src="/images/akf0epavr00o2vo857lc.gif" alt="Alt Text"></p>
<p>The CORS mechanism within the browser checks whether the value of the <code>Access-Control-Allow-Origin</code> header equals the value of the <code>Origin</code> that was sent by the request ğŸ¤šğŸ¼</p>
<blockquote>
<p>æµè§ˆå™¨ä¸­çš„ CORS æœºåˆ¶æ£€æŸ¥ <code>Access-Control-Allow-Origin</code> æ ‡å¤´çš„å€¼æ˜¯å¦ç­‰äºè¯·æ±‚ sent å‘é€çš„ <code>Origin</code> çš„å€¼</p>
</blockquote>
<p>In this case, the origin of our request is <code>https://www.mywebsite.com</code>, which is listed in the <code>Access-Control-Allow-Origin</code> response header!</p>
<blockquote>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹,æˆ‘ä»¬çš„è¯·æ±‚çš„æ¥æºæ˜¯ <code>https://www.mywebsite.com</code> ,å®ƒåˆ—åœ¨ <code>Access-Control-Allow-Origin</code> å“åº”æ ‡å¤´ä¸­ï¼</p>
</blockquote>
<p><img src="/images/foathske6a5prjf02dyf.gif" alt="Alt Text"></p>
<p>Perfect! ğŸ‰ We were able to receive the cross-origin resources successfully! So what happens when weâ€™re trying to access these resources from an origin thatâ€™s not listed in the <code>Access-Control-Allow-Origin</code> header? ğŸ¤”</p>
<blockquote>
<p>å®Œç¾ï¼ ğŸ‰ æˆ‘ä»¬èƒ½å¤ŸæˆåŠŸæ¥æ”¶è·¨åŸŸèµ„æºï¼é‚£ä¹ˆ,å½“æˆ‘ä»¬å°è¯•ä»æœªåœ¨ <code>Access-Control-Allow-Origin</code> æ ‡å¤´ä¸­åˆ—å‡ºçš„æ¥æºè®¿é—®è¿™äº›èµ„æºæ—¶,ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ ğŸ¤”</p>
</blockquote>
<p><img src="/images/lqtoobekf1h1d08lcl56.gif" alt="Alt Text"></p>
<p>Ahh yeah, CORS throws the notorious error that can be so frustrating at times! But now we actually see that it makes total sense</p>
<blockquote>
<p>å—¯,æ˜¯çš„,CORS æŠ›å‡ºäº†ä¸€ä¸ªè‡­åæ˜­è‘—çš„é”™è¯¯,æœ‰æ—¶å¯èƒ½ä¼šä»¤äººæ²®ä¸§ï¼ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å®é™…ä¸Šçœ‹åˆ°è¿™å®Œå…¨æœ‰æ„ä¹‰</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">The &#39;Access-Control-Allow-Origin&#39; header has a value
  &#39;https:&#x2F;&#x2F;www.mywebsite.com&#39; that is not equal
to the supplied origin.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>In this case, the supplied origin was <code>https://www.anotherwebsite.com</code>. However, the server didnâ€™t have this supplied origin in the list of allowed origins in the <code>Access-Control-Allow-Origin</code> header! CORS successfully blocked the request, and we cannot access the fetched data in our code ğŸ˜ƒ</p>
<blockquote>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹,æä¾›çš„æ¥æºæ˜¯ <code>https://www.anotherwebsite.com</code> .ä½†æ˜¯,æœåŠ¡å™¨åœ¨ <code>Access-Control-Allow-Origin</code> æ ‡å¤´ä¸­çš„å…è®¸æ¥æºåˆ—è¡¨ä¸­æ²¡æœ‰æä¾›çš„æ¥æºï¼ CORS æˆåŠŸé˜»æ­¢äº†è¯¥è¯·æ±‚,å› æ­¤æˆ‘ä»¬ä»£ç ä¸­çš„æ— æ³•è®¿é—®æå–æ•°æ®</p>
</blockquote>
<blockquote>
<p>CORS also allows us to add the wildcard <code>*</code> as the value for the allowed origins. This means that requests from <em>all origins</em> should have access to the requested resources, so be careful!</p>
</blockquote>
<blockquote>
<p>CORS è¿˜å…è®¸æˆ‘ä»¬å°†é€šé…ç¬¦ <code>*</code> æ·»åŠ ä¸ºå…è®¸çš„æ¥æºçš„å€¼.è¿™æ„å‘³ç€æ¥è‡ªæ‰€æœ‰æ¥æºçš„è¯·æ±‚éƒ½åº”è¯¥å¯ä»¥è®¿é—®æ‰€è¯·æ±‚çš„èµ„æº,å› æ­¤è¯·å°å¿ƒï¼</p>
</blockquote>
<hr>
<p><code>Access-Control-Allow-Origin</code> is one of the many CORS headers we can provide. A server developer can extend the serverâ€™s CORS policies in order to (dis)allow certain requests! ğŸ’ªğŸ¼</p>
<blockquote>
<p><code>Access-Control-Allow-Origin</code> æ˜¯æˆ‘ä»¬å¯ä»¥æä¾›çš„è®¸å¤š CORS æ ‡å¤´ä¹‹ä¸€.æœåŠ¡å™¨å¼€å‘äººå‘˜å¯ä»¥æ‰©å±•æœåŠ¡å™¨çš„ CORS ç­–ç•¥,ä»¥(ç¦æ­¢)æŸäº›è¯·æ±‚ï¼ ğŸ’ªğŸ¼</p>
</blockquote>
<p>Another common header is the <code>Access-Control-Allow-Methods</code> header! CORS will only allow cross-origin requests if they were sent with the listed methods.</p>
<blockquote>
<p>å¦ä¸€ä¸ªå¸¸è§çš„æ ‡å¤´æ˜¯ <code>Access-Control-Allow-Methods</code> æ ‡å¤´ï¼å¦‚æœ CORS æ˜¯ä½¿ç”¨åˆ—å‡ºçš„æ–¹æ³•å‘é€çš„,åˆ™ä»…å…è®¸è·¨åŸŸè¯·æ±‚.</p>
</blockquote>
<p><img src="/images/yjjhg7yr3kjrh1nm44mo.gif" alt="Alt Text"></p>
<p>In this case, only requests with a <code>GET</code>, <code>POST</code>, or <code>PUT</code> method will be allowed! Other methods such as <code>PATCH</code> or <code>DELETE</code> will be blocked âŒ</p>
<blockquote>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹,ä»…å…è®¸ä½¿ç”¨ <code>GET</code>,<code>POST</code> æˆ– <code>PUT</code> æ–¹æ³•çš„è¯·æ±‚ï¼è¯¸å¦‚ <code>PATCH</code> æˆ– <code>DELETE</code> ä¹‹ç±»çš„å…¶ä»–æ–¹æ³•å°†è¢«é˜»æ­¢ âŒ</p>
</blockquote>
<blockquote>
<p>If youâ€™re curious about what the other possible CORS headers are and what theyâ€™re used for, <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#The_HTTP_response_headers">check out this list</a>.</p>
</blockquote>
<blockquote>
<p>å¦‚æœæ‚¨å¯¹å…¶ä»–å¯èƒ½çš„ CORS æ ‡å¤´æ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬çš„ç”¨é€”æ„Ÿåˆ°å¥½å¥‡,è¯·æŸ¥çœ‹æ­¤åˆ—è¡¨.</p>
</blockquote>
<p>Speaking of <code>PUT</code>, <code>PATCH</code>, and <code>DELETE</code> requests, CORS actually handles those requests differently! ğŸ™ƒ These â€œ<em>non-simple</em>â€œ requests initiate something called a <strong>preflight request</strong>!</p>
<blockquote>
<p>è¯´åˆ° <code>PUT</code>,<code>PATCH</code> å’Œ <code>DELETE</code> è¯·æ±‚,CORS å®é™…ä¸Šä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¿™äº›è¯·æ±‚ï¼ ğŸ™ƒ è¿™äº›â€éç®€å•â€è¯·æ±‚ä¼šå¯åŠ¨æ‰€è°“çš„é¢„æ£€è¯·æ±‚ï¼</p>
</blockquote>
<hr>
<h2 id="ğŸš€-Preflighted-Requests"><a href="#ğŸš€-Preflighted-Requests" class="headerlink" title="ğŸš€ Preflighted Requests"></a>ğŸš€ Preflighted Requests</h2><p>CORS has two types of requests: a <strong>simple request</strong> and a <strong>preflighted request</strong>. Whether a request is simple or preflighted depends on some values within the request (donâ€™t worry, you donâ€™t have to memorize this lol).</p>
<blockquote>
<p>CORS æœ‰ä¸¤ç§ç±»å‹çš„è¯·æ±‚:ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚.è¯·æ±‚æ˜¯ç®€å•çš„è¿˜æ˜¯é¢„æ£€çš„å–å†³äºè¯·æ±‚ä¸­çš„æŸäº›å€¼(ä¸ç”¨æ‹…å¿ƒ,æ‚¨ä¸å¿…è®°ä½è¿™ä¸ª).</p>
</blockquote>
<p>A request is simple when the request is a <code>GET</code> or <code>POST</code> method and doesnâ€™t have any custom headers! Any other request, such as requests with a <code>PUT</code>, <code>PATCH</code>, or <code>DELETE</code> method, will be preflighted.</p>
<blockquote>
<p>å¦‚æœè¯·æ±‚æ˜¯ <code>GET</code> æˆ– <code>POST</code> æ–¹æ³•ä¸”æ²¡æœ‰ä»»ä½•è‡ªå®šä¹‰æ ‡å¤´,åˆ™è¯·æ±‚æ˜¯ç®€å•ï¼å…¶ä»–ä»»ä½•è¯·æ±‚(ä¾‹å¦‚å¸¦æœ‰ <code>PUT</code>,<code>PATCH</code> æˆ– <code>DELETE</code> æ–¹æ³•çš„è¯·æ±‚)å°†è¢«é¢„æ£€.</p>
</blockquote>
<blockquote>
<p>In case youâ€™re just curious about which requirements a request has to meet in order to be a simple request, MDN has <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#Simple_requests">a useful list</a>!</p>
</blockquote>
<blockquote>
<p>å¦‚æœæ‚¨åªæ˜¯æƒ³çŸ¥é“ä¸€ä¸ªç®€å•çš„è¯·æ±‚å¿…é¡»æ»¡è¶³å“ªäº›è¦æ±‚,MDN ä¼šæä¾›æœ‰ç”¨çš„æ¸…å•ï¼</p>
</blockquote>
<p>Okay sure, but what does â€œpreflighted requestâ€ even mean, and why does this happen?</p>
<blockquote>
<p>å¥½çš„,ä½†æ˜¯â€é¢„æ£€è¯·æ±‚â€åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€,ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p>
</blockquote>
<hr>
<p>Before the actual request gets sent, the client generates a preflighted request! The preflighted request contains information about the actual request weâ€™re about to in its <code>Access-Control-Request-*</code> headers ğŸ”¥</p>
<blockquote>
<p>åœ¨å‘é€å®é™…è¯·æ±‚ä¹‹å‰,å®¢æˆ·ç«¯ä¼šç”Ÿæˆé¢„æ£€è¯·æ±‚ï¼é¢„æ£€è¯·æ±‚åœ¨å…¶ <code>Access-Control-Request-*</code> æ ‡å¤´ä¸­åŒ…å«æœ‰å…³æˆ‘ä»¬å®é™…è¦å¤„ç†çš„è¯·æ±‚çš„ä¿¡æ¯ ğŸ”¥</p>
</blockquote>
<p>This gives the server information about the actual request that the browser is trying to make: what is the <strong>method</strong> of the request, what are the <strong>additional headers</strong>, and so on.</p>
<blockquote>
<p>è¿™ä¸ºæœåŠ¡å™¨æä¾›äº†æœ‰å…³æµè§ˆå™¨è¯•å›¾å‘å‡ºçš„å®é™…è¯·æ±‚çš„ä¿¡æ¯:è¯·æ±‚çš„æ–¹æ³•æ˜¯ä»€ä¹ˆ,é™„åŠ çš„å¤´æ˜¯ä»€ä¹ˆ,ç­‰ç­‰.</p>
</blockquote>
<p><img src="/images/pp30p7ej496f8bqta4he.gif" alt="Alt Text"></p>
<p>The server receives this preflighted request, and sends an empty HTTP response back with the serverâ€™s CORS headers! The browser receives the preflight response, which contains no data besides the CORS headers, and checks whether the HTTP request should be allowed! âœ…</p>
<blockquote>
<p>æœåŠ¡å™¨æ¥æ”¶åˆ°æ­¤é¢„æ£€è¯·æ±‚,å¹¶ä½¿ç”¨æœåŠ¡å™¨çš„ CORS æ ‡å¤´å‘é€å›ç©ºçš„ HTTP å“åº”ï¼æµè§ˆå™¨æ”¶åˆ°é¢„æ£€å“åº”,è¯¥å“åº”é™¤äº† CORS æ ‡å¤´å¤–ä¸åŒ…å«ä»»ä½•æ•°æ®,å¹¶æ£€æŸ¥æ˜¯å¦åº”å…è®¸ HTTP è¯·æ±‚ï¼ âœ…</p>
</blockquote>
<p><img src="/images/py19auar8xhs933ilmsc.gif" alt="Alt Text"></p>
<p>If thatâ€™s the case, the browser sends the actual request to the server, which then responds with the data we asked for!</p>
<blockquote>
<p>å¦‚æœæ˜¯è¿™ç§æƒ…å†µ,æµè§ˆå™¨ä¼šå°†å®é™…è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨,ç„¶åæœåŠ¡å™¨ç”¨æˆ‘ä»¬è¦æ±‚çš„æ•°æ®è¿›è¡Œå“åº”ï¼</p>
</blockquote>
<p><img src="/images/pfv1dcg77yjxbue5ryzf.gif" alt="Alt Text"></p>
<p>However, if itâ€™s not the case, CORS will block the preflighted request, and the actual request never gets sent âœ‹ğŸ¼ The preflighted request is a great way to prevent us from accessing or modifying resources on servers that donâ€™t have any CORS policies enabled (yet)! Servers are now protected from potentially unwanted cross-origin requests ğŸ˜ƒ</p>
<blockquote>
<p>ä½†æ˜¯,å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µ,CORS å°†é˜»æ­¢é¢„æ£€è¯·æ±‚,å¹¶ä¸”å®é™…è¯·æ±‚å°†æ°¸è¿œä¸ä¼šå‘é€ âœ‹ğŸ¼ é¢„æ£€è¯·æ±‚æ˜¯é˜²æ­¢æˆ‘ä»¬è®¿é—®æˆ–ä¿®æ”¹æœªå¯ç”¨ä»»ä½• CORS ç­–ç•¥çš„æœåŠ¡å™¨ä¸Šèµ„æºçš„ä¸€ç§å¥½æ–¹æ³•ï¼ç°åœ¨å¯ä»¥ä¿æŠ¤æœåŠ¡å™¨å…å—æ½œåœ¨çš„è·¨åŸŸè¯·æ±‚çš„æ”»å‡» ğŸ˜ƒ</p>
</blockquote>
<blockquote>
<p>ğŸ’¡ In order to reduce the number of roundtrips to our server, we can cache the preflighted responses by adding an <code>Access-Control-Max-Age</code> header to our CORS requests! We can cache the preflighted response this way, which the browser can use instead of sending a new preflighted request!</p>
</blockquote>
<blockquote>
<p>ğŸ’¡ ä¸ºäº†å‡å°‘å¾€è¿”æœåŠ¡å™¨çš„æ¬¡æ•°,æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ CORS è¯·æ±‚ä¸­æ·»åŠ  <code>Access-Control-Max-Age</code> æ ‡å¤´æ¥ç¼“å­˜é¢„æ£€å“åº”ï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ç¼“å­˜é¢„æ£€å“åº”,æµè§ˆå™¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ä»£æ›¿å‘é€æ–°çš„é¢„æ£€è¯·æ±‚ï¼</p>
</blockquote>
<hr>
<h2 id="ğŸª-Credentials"><a href="#ğŸª-Credentials" class="headerlink" title="ğŸª Credentials"></a>ğŸª Credentials</h2><p>Cookies, authorization headers, and TLS certificates are by default only set on same-origin requests! However, we may want to use these credentials in our cross-origin request. Maybe we want to include cookies on the request that the server can use in order to identify the user!</p>
<blockquote>
<p>Cookie,æˆæƒæ ‡å¤´å’Œ TLS è¯ä¹¦é»˜è®¤æƒ…å†µä¸‹ä»…åœ¨åŒæºè¯·æ±‚ä¸Šè®¾ç½®ï¼ä½†æ˜¯,æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨è·¨åŸŸè¯·æ±‚ä¸­ä½¿ç”¨è¿™äº›å‡­æ®.ä¹Ÿè®¸æˆ‘ä»¬æƒ³åœ¨æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨çš„è¯·æ±‚ä¸­åŒ…å« cookie ä»¥ä¾¿è¯†åˆ«ç”¨æˆ·ï¼</p>
</blockquote>
<p>Although CORS doesnâ€™t include credentials by default, we can change this by adding the <code>Access-Control-Allow-Credentials</code> CORS header! ğŸ‰</p>
<blockquote>
<p>å°½ç®¡ CORS é»˜è®¤æƒ…å†µä¸‹ä¸åŒ…æ‹¬å‡­æ®,ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  <code>Access-Control-Allow-Credentials</code> CORS æ ‡å¤´æ¥æ›´æ”¹æ­¤è®¾ç½®ï¼ ğŸ‰</p>
</blockquote>
<p>If we want to include cookies and other authorization headers to our cross-origin request, we need to set the <code>withCredentials</code> field to <code>true</code> on the request and add the <code>Access-Control-Allow-Credentials</code> header to the response.</p>
<blockquote>
<p>å¦‚æœæˆ‘ä»¬æƒ³åœ¨è·¨åŸŸè¯·æ±‚ä¸­åŒ…å« cookie å’Œå…¶ä»–æˆæƒæ ‡å¤´,åˆ™éœ€è¦åœ¨è¯·æ±‚ä¸Šå°† withCredentials å­—æ®µè®¾ç½®ä¸º true,å¹¶å°† Access-Control-Allow-Credentials æ ‡å¤´æ·»åŠ åˆ°å“åº”ä¸­.</p>
</blockquote>
<p><img src="/images/vg3yo6qfqw12oh0f68yg.gif" alt="Alt Text"></p>
<p>All set! We can now include credentials in our cross-origin request ğŸ¥³</p>
<blockquote>
<p>æå®šï¼ç°åœ¨,æˆ‘ä»¬å¯ä»¥åœ¨è·¨åŸŸè¯·æ±‚ä¸­åŒ…å«å‡­æ® ğŸ¥³</p>
</blockquote>
<hr>
<p>Although I think we can all agree that CORS errors can be frustrating at times, itâ€™s amazing that it enables us to safely make cross-origin requests in the browser (it should receive a bit more love lol) âœ¨</p>
<blockquote>
<p>å°½ç®¡æˆ‘è®¤ä¸ºæˆ‘ä»¬éƒ½åŒæ„ CORS é”™è¯¯æœ‰æ—¶ä¼šä»¤äººæ²®ä¸§,ä½†ä»¤äººæƒŠå¥‡çš„æ˜¯,å®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨æµè§ˆå™¨ä¸­å®‰å…¨åœ°è¿›è¡Œè·¨åŸŸè¯·æ±‚(å®ƒåº”è¯¥ä¼šæ”¶åˆ°æ›´å¤šçš„æ¬¢ç¬‘)âœ¨</p>
</blockquote>
<p>Obviously there is so much more to the same-origin policy and CORS than I was able to cover here in this blog post! Luckily, there are many great resources out there like <a target="_blank" rel="noopener" href="https://livebook.manning.com/book/cors-in-action/part-1/">this one</a> or <a target="_blank" rel="noopener" href="https://www.w3.org/wiki/CORS_Enabled">the W3 spec</a> if you want to read more about it ğŸ’ªğŸ¼</p>
<blockquote>
<p>æ˜¾ç„¶,åŒæºç­–ç•¥å’Œ CORS è¿œè¿œè¶…å‡ºäº†æˆ‘åœ¨æœ¬åšæ–‡ä¸­èƒ½å¤Ÿä»‹ç»çš„èŒƒå›´ï¼å¹¸è¿çš„æ˜¯,å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šæœ‰å…³å®ƒçš„ä¿¡æ¯,é‚£ä¹ˆè¿™é‡Œæœ‰å¾ˆå¤šå¾ˆæ£’çš„èµ„æº,ä¾‹å¦‚ã€Š W3 è§„èŒƒã€‹.</p>
</blockquote>
<p>And as always, feel free to reach out to me! ğŸ˜Š</p>
<blockquote>
<p>å’Œå¾€å¸¸ä¸€æ ·,éšæ—¶ä¸æˆ‘è”ç³»ï¼ ğŸ˜Š</p>
</blockquote>
<!--
âœ¨ [Twitter](https://www.twitter.com/lydiahallie)

ğŸ‘©ğŸ½â€ğŸ’» [Instagram](https://www.instagram.com/theavocoder)

ğŸ’» [GitHub](https://www.github.com/lydiahallie)

ğŸ’¡ [LinkedIn](https://www.linkedin.com/in/lydia-hallie)

ğŸ“· [YouTube](https://www.youtube.com/channel/UC4EWKIKdKiDtAscQ9BIXwUw)

ğŸ’Œ [Email](mailto:lydiahallie.dev@gmail.com%22) -->

<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">è·¨æºèµ„æºå…±äº«(CORS)</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">æµè§ˆå™¨çš„åŒæºç­–ç•¥</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/CORS-safelisted_response_header">CORS-safelisted response header</a></p>
</blockquote>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Lydia Hallie</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://zhuangyin8.github.io/cs-visualized-cors/">https://zhuangyin8.github.io/cs-visualized-cors/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">Lydia Hallie</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Visualized/">
                                    <span class="chip bg-color">Visualized</span>
                                </a>
                            
                                <a href="/tags/CORS/">
                                    <span class="chip bg-color">CORS</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/job-hunt-interview-questions-2020/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="All front end Interview questions asked during my recent job hunt">
                        
                        <span class="card-title">All front end Interview questions asked during my recent job hunt</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-08-04
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Front-End/" class="post-category">
                                    Front-End
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Interview/">
                        <span class="chip bg-color">Interview</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/10-css-tricks-you-need-to-know-about-part-2/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="10 CSS Tricks You Need to Know About (Part 2)">
                        
                        <span class="card-title">10 CSS Tricks You Need to Know About (Part 2)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-05-29
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CSS/" class="post-category">
                                    CSS
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Tricks/">
                        <span class="chip bg-color">Tricks</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <a href="/about" target="_blank">åº„å¼•</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
